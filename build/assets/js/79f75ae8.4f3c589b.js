"use strict";(globalThis.webpackChunkdocs_neuralk=globalThis.webpackChunkdocs_neuralk||[]).push([[5755],{5546:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"plot_two_moon_classification","title":"plot_two_moon_classification","description":"This example demonstrates how to use the NeuralkAI SDK to:","source":"@site/docs/plot_two_moon_classification.md","sourceDirName":".","slug":"/plot_two_moon_classification","permalink":"/docs/plot_two_moon_classification","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Categorization module","permalink":"/docs/plot_categorization"}}');var s=t(4848),i=t(8453);const o={},l="NeuralkAI Classifier Workflow Example",r={},c=[{value:"Step 1 - Import required libraries",id:"step-1---import-required-libraries",level:2},{value:"Step 2 - Load credentials and connect to the NeuralkAI platform",id:"step-2---load-credentials-and-connect-to-the-neuralkai-platform",level:2},{value:"Step 4 - Create a new project and upload precomputed moons dataset",id:"step-4---create-a-new-project-and-upload-precomputed-moons-dataset",level:2},{value:"Step 5 - Create a classifier training analysis",id:"step-5---create-a-classifier-training-analysis",level:2},{value:"Step 6 - Wait for training to complete",id:"step-6---wait-for-training-to-complete",level:2},{value:"Step 7 - Launch a prediction analysis",id:"step-7---launch-a-prediction-analysis",level:2},{value:"Step 8 - Download prediction results",id:"step-8---download-prediction-results",level:2},{value:"Step 9 - Plot the results",id:"step-9---plot-the-results",level:2},{value:"Step 10 - Clean the environement",id:"step-10---clean-the-environement",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("a",{id:"sphx-glr-auto-examples-plot-two-moon-classification-py"}),"\n",(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"neuralkai-classifier-workflow-example",children:"NeuralkAI Classifier Workflow Example"})}),"\n",(0,s.jsx)(n.p,{children:"This example demonstrates how to use the NeuralkAI SDK to:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create a new project."}),"\n",(0,s.jsx)(n.li,{children:"Upload a synthetic classification dataset (two moons)."}),"\n",(0,s.jsx)(n.li,{children:"Launch and monitor a classifier training analysis."}),"\n",(0,s.jsx)(n.li,{children:"Download training results."}),"\n",(0,s.jsx)(n.li,{children:"Launch and monitor a classifier prediction analysis."}),"\n",(0,s.jsx)(n.li,{children:"Download prediction results."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["We use scikit-learn\u2019s ",(0,s.jsx)(n.code,{children:"make_moons"})," dataset to simulate a binary classification task."]}),"\n",(0,s.jsx)(n.h2,{id:"step-1---import-required-libraries",children:"Step 1 - Import required libraries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:"import os\nimport polars as pl\nimport tempfile\nfrom pathlib import Path\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import accuracy_score\nimport numpy as np\n\nfrom neuralk import Neuralk\nfrom neuralk.datasets import two_moons\n"})}),"\n",(0,s.jsx)(n.h2,{id:"step-2---load-credentials-and-connect-to-the-neuralkai-platform",children:"Step 2 - Load credentials and connect to the NeuralkAI platform"}),"\n",(0,s.jsx)(n.p,{children:"Instead of hardcoding your credentials, you should store them securely in environment variables."}),"\n",(0,s.jsx)(n.p,{children:"The most common approaches are:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Environment variables in the operating system"})}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["On Linux/macOS with Bash:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-default",children:"export NEURALK_USERNAME=your_username\nexport NEURALK_PASSWORD=your_password\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["On Windows (Command Prompt):","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-default",children:"set NEURALK_USERNAME=your_username\nset NEURALK_PASSWORD=your_password\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Using a \u2018.env\u2019 file"})," (useful during development)"]}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a file named ",(0,s.jsx)(n.code,{children:".env"})," in the root of your project with:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-default",children:"NEURALK_USERNAME=your_username\nNEURALK_PASSWORD=your_password\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Then use ",(0,s.jsx)(n.code,{children:"python-dotenv"})," to load these variables into your environment."]}),"\n",(0,s.jsxs)(n.li,{children:["Don\u2019t forget to add ",(0,s.jsx)(n.code,{children:".env"})," to your ",(0,s.jsx)(n.code,{children:".gitignore"})," to avoid committing it."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["We try to load the ",(0,s.jsx)(n.code,{children:".env"})," file automatically, but if it\u2019s not available, the code still works\nas long as the variables are set in the system environment."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'try:\n    # Try to load .env file if python-dotenv is available\n    from dotenv import load_dotenv\n\n    load_dotenv()\nexcept ImportError:\n    print("python-dotenv not installed, skipping .env loading")\n\nuser = os.environ.get("NEURALK_USERNAME")\npassword = os.environ.get("NEURALK_PASSWORD")\n\nassert (\n    user is not None and password is not None\n), "Missing NEURALK_USERNAME or NEURALK_PASSWORD. Set them in your environment or a .env file."\n\nclient = Neuralk(user, password)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-4---create-a-new-project-and-upload-precomputed-moons-dataset",children:"Step 4 - Create a new project and upload precomputed moons dataset"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'for project in client.projects.get_list():\n    if project.name == "MoonsExample":\n        client.projects.delete(project)\n\nproject = client.projects.create("MoonsExample")\nprint("Project created:", project)\n\nmoons_data = two_moons()\nprint(moons_data["path"])\n\ndataset = client.datasets.create(\n    project,\n    "MoonsExample",\n    moons_data["path"],\n)\n\nclient.datasets.wait_until_complete(dataset, verbose=True)\nprint("Dataset uploaded:", dataset)\n\nimport time\ntime.sleep(5)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-5---create-a-classifier-training-analysis",children:"Step 5 - Create a classifier training analysis"}),"\n",(0,s.jsx)(n.p,{children:"We specify the column to predict (\u201clabel\u201d) and the features to use."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'analysis_fit = client.analysis.create_classifier_fit(\n    dataset,\n    "Two Moons Classifier",\n    target_column="label",\n    feature_column_name_list=["feature1", "feature2"],\n)\nprint("Classifier training analysis created:", analysis_fit)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-6---wait-for-training-to-complete",children:"Step 6 - Wait for training to complete"}),"\n",(0,s.jsx)(n.p,{children:"We monitor the training progress until it\u2019s complete."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:"analysis_fit = client.analysis.wait_until_complete(analysis_fit, verbose=True)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"step-7---launch-a-prediction-analysis",children:"Step 7 - Launch a prediction analysis"}),"\n",(0,s.jsx)(n.p,{children:"We reuse the same dataset and model to perform predictions."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'analysis_predict = client.analysis.create_classifier_predict(\n    dataset, "Two Moons Prediction", analysis_fit\n)\nprint("Prediction analysis launched:", analysis_predict)\nanalysis_predict = client.analysis.wait_until_complete(analysis_predict,\n                                                       verbose=True)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-8---download-prediction-results",children:"Step 8 - Download prediction results"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'with tempfile.TemporaryDirectory() as results_dir:\n    client.analysis.download_results(analysis_predict, folder_path=results_dir)\n    print("Prediction results downloaded to temporary directory")\n    results_file = next(Path(results_dir).iterdir())\n    y_pred = pl.read_parquet(results_file)["label"].to_numpy()\n\nX = pl.read_csv(moons_data["path"])\ny = X["label"].to_numpy()\nX = X.drop("label").to_numpy()\n\nacc = accuracy_score(y, y_pred)\nprint(f"Accuracy of classification: {acc}")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-9---plot-the-results",children:"Step 9 - Plot the results"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:'plt.rcParams.update(\n    {\n        "axes.edgecolor": "#4d4d4d",\n        "axes.linewidth": 1.2,\n        "axes.facecolor": "#f5f5f5",\n        "figure.facecolor": "white",\n    }\n)\n\nfig, axes = plt.subplots(1, 2, figsize=(11, 5), dpi=120)\ntitles = ["Ground Truth", f"Model Prediction\\nAccuracy: {acc:.2f}"]\ncolors = ["#1a73e8", "#ffa600"]  # Professional blue & orange\n\nfor idx, ax in enumerate(axes):\n    labels = y if idx == 0 else y_pred\n    for lab in np.unique(labels):\n        ax.scatter(\n            X[labels == lab, 0],\n            X[labels == lab, 1],\n            s=70,\n            marker="o",\n            c=colors[lab],\n            edgecolors="white",\n            linewidths=0.8,\n            alpha=0.9,\n            label=f"Class {lab}" if idx == 0 else None,  # Legend only on first panel\n            zorder=3,\n        )\n\n    # Aesthetics\n    ax.set_xticks([])\n    ax.set_yticks([])\n    ax.set_aspect("equal")\n    ax.set_title(titles[idx], fontsize=14, weight="bold", pad=12)\n    ax.grid(False)\n\n    # Subtle outer border (inside the axes limits)\n    x_margin = 0.4\n    y_margin = 0.4\n    ax.set_xlim(X[:, 0].min() - x_margin, X[:, 0].max() + x_margin)\n    ax.set_ylim(X[:, 1].min() - y_margin, X[:, 1].max() + y_margin)\n\n    # Panel annotation (A, B)\n    ax.text(\n        0.05,\n        0.98,\n        chr(ord("A") + idx),\n        transform=ax.transAxes,\n        fontsize=16,\n        fontweight="bold",\n        va="top",\n        ha="right",\n    )\n\n# Shared legend beneath the plots\nhandles, labels_ = axes[0].get_legend_handles_labels()\nfig.legend(\n    handles,\n    labels_,\n    loc="lower center",\n    ncol=2,\n    frameon=False,\n    fontsize=12,\n    bbox_to_anchor=(0.5, 0.02),\n)\n\nfig.tight_layout()\nplt.subplots_adjust(bottom=0.05)\nplt.show()\n'})}),"\n",(0,s.jsx)(n.h2,{id:"step-10---clean-the-environement",children:"Step 10 - Clean the environement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Python",children:"client.logout()\n"})}),"\n",(0,s.jsx)("a",{id:"sphx-glr-download-auto-examples-plot-two-moon-classification-py"})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var a=t(6540);const s={},i=a.createContext(s);function o(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);