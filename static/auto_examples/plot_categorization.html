
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NeuralkAI Categorization Example &#8212; Neuralk SDK 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f5508e09" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/plot_categorization';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NeuralkAI Enrichment Workflow Example" href="plot_enrichment_amazon_reviews.html" />
    <link rel="prev" title="Example Gallery" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.0.1" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><a href=https://lu.ma/lcdlh40z>Your exclusive chance to test our Tabular Foundation Model on your data: join the online workshop on July 30th  -></a></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://www.neuralk-ai.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Neuralk SDK 0.0.1 documentation - Home"/>
    <img src="../_static/logo-dark.svg" class="logo__image only-dark pst-js-only" alt="Neuralk SDK 0.0.1 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../pages/getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../pages/getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">NeuralkAI Categorization  Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_enrichment_amazon_reviews.html">NeuralkAI Enrichment Workflow Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_two_moon_classification.html">NeuralkAI Classifier Workflow Example</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Example Gallery</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">NeuralkAI Categorization  Example</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-categorization-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="neuralkai-categorization-example">
<span id="sphx-glr-auto-examples-plot-categorization-py"></span><h1>NeuralkAI Categorization  Example<a class="headerlink" href="#neuralkai-categorization-example" title="Link to this heading">#</a></h1>
<p>This example shows how to use the NeuralkAI SDK to predict product categories.
We use a subset of the
<a class="reference external" href="https://github.com/BestBuyAPIs/open-data-set">Best Buy dataset</a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>

<span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">neuralk</span><span class="w"> </span><span class="kn">import</span> <span class="n">Neuralk</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuralk.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">best_buy</span>
</pre></div>
</div>
<section id="loading-username-and-password">
<h2>Loading username and password<a class="headerlink" href="#loading-username-and-password" title="Link to this heading">#</a></h2>
<p>To connect to the Neuralk API, we need to authenticate. Here we read the
username and password from environment variables. We first attempt to load
any variables set in a <a class="reference external" href="https://github.com/theskumar/python-dotenv">dotenv</a>
file.</p>
<p>Then, we can create a <a class="reference internal" href="../api/generated/neuralk.Neuralk.html#neuralk.Neuralk" title="neuralk.Neuralk"><code class="xref py py-class docutils literal notranslate"><span class="pre">Neuralk</span></code></a> client to connect to the API.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>

    <span class="n">load_dotenv</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;python-dotenv not installed, skipping .env loading&quot;</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">user</span></a> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NEURALK_USER&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">password</span></a> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NEURALK_PASSWORD&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Neuralk</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">user</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">password</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="uploading-datasets-into-a-project">
<h2>Uploading datasets into a project<a class="headerlink" href="#uploading-datasets-into-a-project" title="Link to this heading">#</a></h2>
<p>All the datasets and the analyses we run on them belong to a project. Those
are managed through the <code class="docutils literal notranslate"><span class="pre">.projects</span></code> attribute of the <a class="reference internal" href="../api/generated/neuralk.Neuralk.html#neuralk.Neuralk" title="neuralk.Neuralk"><code class="xref py py-class docutils literal notranslate"><span class="pre">Neuralk</span></code></a>
client.</p>
<p>Here we retrieve the <code class="docutils literal notranslate"><span class="pre">&quot;best_buy&quot;</span></code> project, creating it if it does not exist
yet. Note that we can get the list of all projects accessible from our client
with <a class="reference internal" href="../api/generated/neuralk.Neuralk.projects.get_list.html#neuralk.Neuralk.projects.get_list" title="neuralk.Neuralk.projects.get_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.projects.get_list</span></code></a></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_or_create_project</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">project</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">client</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">get_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">project</span>


<span class="n">project</span> <span class="o">=</span> <span class="n">get_or_create_project</span><span class="p">(</span><span class="s2">&quot;best_buy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The Neuralk SDK package provides a few example datasets with which we can try
out the API in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> module. We obtain the path to a Parquet
file containing a (training) subset of the Best Buy data.</p>
<p>to make the example run fast we use a small subset, pass subsample=False to
run on full dataset</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">local_dataset</span></a> <span class="o">=</span> <span class="n">best_buy</span><span class="p">(</span><span class="n">subsample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">local_dataset</span></a><span class="p">[</span><span class="s2">&quot;train_path&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (100, 7)</small><table border="1" class="dataframe"><thead><tr><th>name</th><th>description</th><th>neuralk categorization level 0</th><th>neuralk categorization level 1</th><th>neuralk categorization level 2</th><th>neuralk categorization level 3</th><th>neuralk categorization level 4</th></tr><tr><td>str</td><td>str</td><td>str</td><td>str</td><td>str</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;EnerPlex - Surfr Amp Battery C…</td><td>&quot;ENERPLEX Surfr Amp Battery Cas…</td><td>&quot;Cell Phones&quot;</td><td>&quot;Cell Phone Accessories&quot;</td><td>&quot;iPhone Accessories&quot;</td><td>&quot;iPhone Cases &amp; Clips&quot;</td><td>null</td></tr><tr><td>&quot;Resident Evil 5 - PRE-OWNED - …</td><td>&quot;Daylight won&#x27;t protect you fro…</td><td>&quot;Video Games&quot;</td><td>&quot;Pre-Owned Games&quot;</td><td>null</td><td>null</td><td>null</td></tr><tr><td>&quot;Elite - 8-Cup Rice Cooker - Wh…</td><td>&quot;Steamer attachment with cool-t…</td><td>&quot;Appliances&quot;</td><td>&quot;Small Kitchen Appliances&quot;</td><td>&quot;Steamers, Rice Cookers &amp; Press…</td><td>&quot;Rice Cookers&quot;</td><td>null</td></tr><tr><td>&quot;VTech - CS6619-16 DECT 6.0 Exp…</td><td>&quot;1 handset includedSpecial Feat…</td><td>&quot;Connected Home &amp; Housewares&quot;</td><td>&quot;Telephones &amp; Communication&quot;</td><td>&quot;Cordless Telephones&quot;</td><td>&quot;Systems&quot;</td><td>null</td></tr><tr><td>&quot;Apple - Certified Pre-Owned iP…</td><td>&quot;Certified Pre-Owned5.5-inch Re…</td><td>&quot;Cell Phones&quot;</td><td>&quot;Refurbished &amp; Pre-Owned Phones&quot;</td><td>&quot;Pre-Owned Phones&quot;</td><td>null</td><td>null</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;mophie - juice pack air Chargi…</td><td>&quot;Compatible with Apple iPhone S…</td><td>&quot;Cell Phones&quot;</td><td>&quot;Cell Phone Accessories&quot;</td><td>&quot;iPhone Accessories&quot;</td><td>&quot;iPhone Cases &amp; Clips&quot;</td><td>null</td></tr><tr><td>&quot;Metra - Turbo Wire Harness Ada…</td><td>&quot;From our expanded online assor…</td><td>&quot;Car Electronics &amp; GPS&quot;</td><td>&quot;Car Installation Parts &amp; Acces…</td><td>&quot;Car Audio Installation Parts&quot;</td><td>&quot;Deck Installation Parts&quot;</td><td>&quot;Deck Harnesses&quot;</td></tr><tr><td>&quot;Isaac Mizrahi - Smartwatch 42m…</td><td>&quot;Compatible with select Apple a…</td><td>&quot;Cell Phones&quot;</td><td>&quot;Cell Phone Accessories&quot;</td><td>&quot;Smartwatches &amp; Accessories&quot;</td><td>&quot;Smartwatches&quot;</td><td>null</td></tr><tr><td>&quot;Nintendo Selects: Super Mario …</td><td>&quot;Leave gravity at home and enjo…</td><td>&quot;Video Games&quot;</td><td>&quot;Wii&quot;</td><td>&quot;Wii Games&quot;</td><td>null</td><td>null</td></tr><tr><td>&quot;Acer - Aspire Z 23&quot; Touch-Scre…</td><td>&quot;Windows 8.1, upgrade to Window…</td><td>&quot;Computers &amp; Tablets&quot;</td><td>&quot;Desktop &amp; All-in-One Computers&quot;</td><td>&quot;All Desktops&quot;</td><td>null</td><td>null</td></tr></tbody></table></div>
</div>
<br />
<br /><p>To run an analysis, we need to create a dataset on the platform. Those are
managed through the <code class="docutils literal notranslate"><span class="pre">.datasets</span></code> attribute of the <a class="reference internal" href="../api/generated/neuralk.Neuralk.html#neuralk.Neuralk" title="neuralk.Neuralk"><code class="xref py py-class docutils literal notranslate"><span class="pre">Neuralk</span></code></a> client.</p>
<p>The data is uploaded to our project with <a class="reference internal" href="../api/generated/neuralk.Neuralk.datasets.create.html#neuralk.Neuralk.datasets.create" title="neuralk.Neuralk.datasets.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.datasets.create</span></code></a>. We
pass the project object, a name for the dataset, and the local path of the
CSV or Parquet file (in this case, Parquet) to upload.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">project</span><span class="p">,</span> <span class="s2">&quot;best_buy_train&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">local_dataset</span></a><span class="p">[</span><span class="s2">&quot;train_path&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fitting-a-product-categorization-workflow">
<h2>Fitting a product categorization workflow<a class="headerlink" href="#fitting-a-product-categorization-workflow" title="Link to this heading">#</a></h2>
<p>The next step is to fit a workflow on the training data. Later, we will be
able to use it to categorize new products for which we do not have a ground
truth.</p>
<p>Analyses are managed through the <code class="docutils literal notranslate"><span class="pre">analysis</span></code> attribute of the
<a class="reference internal" href="../api/generated/neuralk.Neuralk.html#neuralk.Neuralk" title="neuralk.Neuralk"><code class="xref py py-class docutils literal notranslate"><span class="pre">Neuralk</span></code></a> client. We launch the fit of our workflow by creating a
“categorization fit” analysis with
<a class="reference internal" href="../api/generated/neuralk.Neuralk.analysis.create_categorization_fit.html#neuralk.Neuralk.analysis.create_categorization_fit" title="neuralk.Neuralk.analysis.create_categorization_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.analysis.create_categorization_fit</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_fit</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">create_categorization_fit</span><span class="p">(</span>
    <span class="n">train_dataset</span><span class="p">,</span>
    <span class="s2">&quot;best_buy_fit&quot;</span><span class="p">,</span>
    <span class="n">target_columns</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;neuralk categorization level 0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;neuralk categorization level 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;neuralk categorization level 2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;neuralk categorization level 3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;neuralk categorization level 4&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorization fit analysis created:&quot;</span><span class="p">,</span> <span class="n">analysis_fit</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Categorization fit analysis created: Analysis(id=&#39;0ffd5794-81fa-4656-adce-97f4aaffedf8&#39;, name=&#39;best_buy_fit&#39;, error=None, advancement=None, status=&#39;PENDING&#39;)
</pre></div>
</div>
<p><a class="reference internal" href="../api/generated/neuralk.Neuralk.analysis.create_categorization_fit.html#neuralk.Neuralk.analysis.create_categorization_fit" title="neuralk.Neuralk.analysis.create_categorization_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.analysis.create_categorization_fit</span></code></a> returns immediately an
<code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code> object that represents the analysis we have just launched.
This analysis has not finished running yet. Depending on our needs, we may
want to continue with other tasks or finish our script at this point. But in
this example, we want to wait and use the fitted model once it is ready.</p>
<p><a class="reference internal" href="../api/generated/neuralk.Neuralk.analysis.wait_until_complete.html#neuralk.Neuralk.analysis.wait_until_complete" title="neuralk.Neuralk.analysis.wait_until_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.analysis.wait_until_complete</span></code></a> allows us to pause the execution
of our script and wait for the analysis to finish (or error). It returns a
new <code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code> object, corresponding to the same analysis but with an
updated status.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_fit</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">wait_until_complete</span><span class="p">(</span><span class="n">analysis_fit</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Analysis status: None

Analysis status: PENDING

Analysis status: RUNNING

Analysis status: SUCCEEDED ✅
</pre></div>
</div>
</section>
<section id="using-the-fitted-workflow">
<h2>Using the fitted workflow<a class="headerlink" href="#using-the-fitted-workflow" title="Link to this heading">#</a></h2>
<p>Now that we have fitted our categorizer, we can use it for some new, unseen
products.</p>
<p>We start by creating a new dataset to upload the unseen data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">project</span><span class="p">,</span> <span class="s2">&quot;best_buy_train&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">local_dataset</span></a><span class="p">[</span><span class="s2">&quot;test_path&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We can now apply the fitted workflow to the <code class="docutils literal notranslate"><span class="pre">test_dataset</span></code> we just created.
This is done with <a class="reference internal" href="../api/generated/neuralk.Neuralk.analysis.create_categorization_predict.html#neuralk.Neuralk.analysis.create_categorization_predict" title="neuralk.Neuralk.analysis.create_categorization_predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.analysis.create_categorization_predict</span></code></a>, to
which we pass the new dataset, a name for the analysis, and the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code> object resulting from fitting the model we wish to use now.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_predict</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">create_categorization_predict</span><span class="p">(</span>
    <span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;best_buy_predict&quot;</span><span class="p">,</span> <span class="n">analysis_fit</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorization fit analysis created:&quot;</span><span class="p">,</span> <span class="n">analysis_fit</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Categorization fit analysis created: Analysis(id=&#39;0ffd5794-81fa-4656-adce-97f4aaffedf8&#39;, name=&#39;best_buy_fit&#39;, error=None, advancement=100, status=&#39;SUCCEEDED&#39;)
</pre></div>
</div>
<p>As before, we wait until the analysis finishes before continuing the example.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_predict</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">wait_until_complete</span><span class="p">(</span><span class="n">analysis_predict</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Analysis status: None

Analysis status: PENDING

Analysis status: RUNNING

Analysis status: SUCCEEDED ✅
</pre></div>
</div>
</section>
<section id="downloading-the-prediction-results">
<h2>Downloading the prediction results<a class="headerlink" href="#downloading-the-prediction-results" title="Link to this heading">#</a></h2>
<p>Now that our prediction analyis is complete, we want to download the
predictions. This is done with <a class="reference internal" href="../api/generated/neuralk.Neuralk.analysis.download_results.html#neuralk.Neuralk.analysis.download_results" title="neuralk.Neuralk.analysis.download_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Neuralk.analysis.download_results</span></code></a>, to
which we pass the reference to the prediction analysis whose results we want.</p>
<p>All the results are stored in the provided directory, from which we can load
them to use as we wish.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <a href="https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryDirectory" title="tempfile.TemporaryDirectory" class="sphx-glr-backref-module-tempfile sphx-glr-backref-type-py-class"><span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span></a><span class="p">()</span> <span class="k">as</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">results_dir</span></a><span class="p">:</span>
    <span class="n">client</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">download_results</span><span class="p">(</span><span class="n">analysis_predict</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">results_dir</span></a><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction results downloaded to temporary directory&quot;</span><span class="p">)</span>
    <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">results_file</span></a> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">results_dir</span></a><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">results_file</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Prediction results downloaded to temporary directory
(100, 5)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 55.692 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-categorization-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/207b442955c6569e2f0ec61e3dd186fd/plot_categorization.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_categorization.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/3b46450b6f13b0434d9698992063feca/plot_categorization.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_categorization.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/aac858fc183c6ab01f12e5a9a2f62a76/plot_categorization.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_categorization.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example Gallery</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_enrichment_amazon_reviews.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">NeuralkAI Enrichment Workflow Example</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-username-and-password">Loading username and password</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uploading-datasets-into-a-project">Uploading datasets into a project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-a-product-categorization-workflow">Fitting a product categorization workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-fitted-workflow">Using the fitted workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-prediction-results">Downloading the prediction results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Neuralk-AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>